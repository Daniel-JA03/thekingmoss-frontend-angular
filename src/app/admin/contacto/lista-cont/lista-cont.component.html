<div class="container-fluid mt-4 px-4">
  <h3 class="title">Mensajes de Contacto</h3>

  <!-- Filtros -->
  <div class="d-flex mb-3 gap-2">
    <button class="btn btn-outline-primary btn-sm" [class.active]="filtro === 'todos'" (click)="cambiarFiltro('todos')">
      Todos
    </button>
    <button class="btn btn-outline-success btn-sm" [class.active]="filtro === 'leidos'" (click)="cambiarFiltro('leidos')">
      Leídos
    </button>
    <button class="btn btn-outline-warning btn-sm" [class.active]="filtro === 'nopendientes'" (click)="cambiarFiltro('nopendientes')">
      No Leídos
    </button>
  </div>

  <!-- Tabla de mensajes -->
  <div class="table-container-full">
    <table class="table table-striped table-hover custom-table align-middle">
      <thead class="table-dark">
        <tr>
          <th>Estado</th>
          <th>Nombre</th>
          <th>Email</th>
          <th>Asunto</th>
          <th>Mensaje</th>
          <th>Fecha</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let msg of mensajesFiltrados" [class.table-warning]="msg.estado === 'NUEVO'">
          <td>
            <span class="badge" 
                  [class.bg-success]="msg.estado === 'LEIDO'" 
                  [class.bg-warning]="msg.estado === 'NUEVO'">
              {{ msg.estado === 'LEIDO' ? 'Leído' : 'Nuevo' }}
            </span>
          </td>
          <td>{{ msg.nombre }}</td>
          <td>{{ msg.email }}</td>
          <td>{{ msg.asunto || 'Sin asunto' }}</td>
          <td class="text-truncate" style="max-width: 300px;">
            {{ msg.mensaje }}
          </td>
          <td>{{ msg.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>
            <button class="btn btn-sm" 
                    [class.btn-success]="msg.estado === 'LEIDO'" 
                    [class.btn-secondary]="msg.estado === 'NUEVO'" 
                    (click)="marcarComoLeido(msg)">
              <i class="bi" 
                 [class.bi-envelope-check]="msg.estado === 'LEIDO'" 
                 [class.bi-envelope]="msg.estado === 'NUEVO'"></i>
              {{ msg.estado === 'LEIDO' ? 'Leído' : 'Marcar como leído' }}
            </button>
            <button class="btn btn-sm btn-info text-white ms-1" (click)="responderMensaje(msg)">
              <i class="bi bi-reply"></i> Responder
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="mensajes.length === 0" class="alert alert-info text-center">
      No hay mensajes de contacto registrados.
    </div>
  </div>
</div>